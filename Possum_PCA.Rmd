
#Install Packages
```{r}
#install.packages("factoextra")
#install.packages("forcats")
```



```{r}
library(readr)
library(tidyverse)
library(factoextra)
library(forcats)
```


```{r}
possum_raw <- read_csv("possum.csv")
#View(possum_raw)
```


```{r}

possum <- data.frame(possum_raw, row.names = 1)
#View(possum)
summary(possum)
```


```{r}
possum_clean = na.omit(possum)
str(possum_clean)
summary(possum_clean)

```




```{r}
possum_pca = subset(possum_clean, select = -c(site, Pop, sex))
possum.pca = prcomp(possum_pca, center = TRUE, scale. = TRUE)
summary(possum.pca)
#View(possum.pca$rotation)
possum.pca$rotation
```



```{r}
PCNames = c("age", "hdlngth", "skullw", "totlngth", "taill", "footlgth", "earconch", "eye", "chest", "belly")
```


```{r}
PC1 = possum.pca$rotation[1:10]
PC1_DF = tibble(PCNames, PC1)
str(PC1_DF)
#View(PC1_DF)
```


```{r}
PC2 = possum.pca$rotation[11:20]
PC2_DF = tibble(PCNames, PC2)
str(PC2_DF)
```


```{r}
PC3 = possum.pca$rotation[21:30]
PC3_DF = tibble(PCNames, PC3)
str(PC3_DF)
```

```{r}
ggplot(PC1_DF, aes(x = fct_reorder(PCNames,PC1) , y = PC1)) + 
  geom_col()+
  labs(x = "Variable", y = "Effect on PC1")

```



```{r}
ggplot(PC2_DF, aes(x = fct_reorder(PCNames,PC2) , y = PC2)) + 
  geom_col() +
  labs(x = "Variable", y = "Effect on PC2")

```


```{r}
ggplot(PC3_DF, aes(x = fct_reorder(PCNames,PC3) , y = PC3)) + 
  geom_col() +
  labs(x = "Variable", y = "Effect on PC3")

```




```{r}

fviz_eig(possum.pca)
fviz_pca_ind(possum.pca,
             axes = c(2,1),
             col.ind = "cos2", # Color by quality of representation
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE #Avoid text overlapping
             )

```


```{r}
fviz_pca_ind(possum.pca,
             axes = c(2,1),
             col.ind = "cos2", # Color by quality of representation
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE #Avoid text overlapping
             )
```



```{r}
fviz_pca_var(possum.pca,
             axes = c(2,1),
             col.var = "contrib", # Color by contributions to the PC
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE #Avoid text overlapping
             )
```


```{r}
fviz_pca_biplot(possum.pca, repel = TRUE,
                axes = c(2,1),
                col.var = "#2E9FDF", # Variables color
                col.ind = "#696969" #Individuals color
                )

fviz_pca_biplot(possum.pca, repel = TRUE,
                axes = c(2,1),
                col.var = "contrib", # Color by contributions to the PC
                gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                )
```


```{r}
biplot(possum.pca, choices = 2:1, scale = 1, pc.biplot = FALSE)
```


```{r}
coord = possum.pca$x # pulls out just the info from the pca results
plot(coord[,1], coord[,2]) # plots the first two axes of the pca
plot(coord[,1], coord[,2], cex= 0.1*possum_pca$age) # now the symbol size tells you age
#text(coord[,1], coord[,2], row.names(possum_pca))
```

```{r}
ggplot() +
  geom_point(data = coord, aes(x = coord[,1], y = coord[,2], col = ))
```


































